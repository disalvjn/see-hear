<style>
 *{margin:0;padding:0;}body{background:#222;}
 canvas{
     position:absolute;
     /* border:5px solid rgba(255,255,255,0.1); */
     /* box-shadow:inset 0 0 100px #4162a9; */
     transform:translateZ(0);
 }
</style>
<canvas id="canvas"></canvas>
<script>

 function interpret(ctx, event) {
     event.draw.forEach(item => {
         if (item.type == 'draw' && item.shape == 'circle') {
             ctx.fillStyle = item.color;
             ctx.strokeStyle = item.color;

             ctx.beginPath();
             ctx.arc(item.x, item.y, item.radius, 0, Math.PI*2, true);
             if (item.fill) {
                 ctx.fill();
             } else {
                 ctx.stroke();
             }
             ctx.closePath();

         } else if (item.type == 'draw' && item.shape == 'line') {
             ctx.strokeStyle = item.color;
             ctx.beginPath();
             ctx.moveTo(item["from-x"], item["from-y"]);
             ctx.lineTo(item["to-x"], item["to-y"]);
             ctx.stroke();
         }
     });
 }

 let canvas = document.getElementById('canvas');
 let ctx = canvas.getContext('2d');
 ctx.linewidth = 0.5; // move into interpreter
 ctx.globalCompositeOperation = 'lighter';

 let ws = new WebSocket("ws://localhost:8080");
 ws.onmessage = function(event) {
     /* ctx.clearRect(0, 0, 500, 500); */
     interpret(ctx, JSON.parse(event.data));
 }

 let magic = 500;

 canvas.width = 500;
 canvas.height = 500;
 canvas.style.left = (window.innerWidth - 500)/2+'px';

 if(window.innerHeight>500)
     canvas.style.top = (window.innerHeight - 500)/2+'px';

 /* /*** //
  * *    particles = [],
  * * patriclesNum = 500,
  * *            w = 500,
  * *            h = 500,
  * *       colors = ['#f35d4f','#f36849','#c0d988','#6ddaf1','#f1e85b'];
  * *
  * *
  * * function Factory(){
  * *   this.x =  Math.round( Math.random() * w);
  * *   this.y =  Math.round( Math.random() * h);
  * *   this.rad = Math.round( Math.random() * 1) + 1;
  * *   this.rgba = colors[ Math.round( Math.random() * 3) ];
  * *   this.vx = Math.round( Math.random() * 3) - 1.5;
  * *   this.vy = Math.round( Math.random() * 3) - 1.5;
  * * }
  * *
  * * function draw(){
  * *   for(var i = 0;i < patriclesNum; i++){
  * *     var temp = particles[i];
  * *     var factor = 1;
  * *
  * *     for(var j = 0; j<patriclesNum; j++){
  * *
  * *        var temp2 = particles[j];
  * *        ctx.linewidth = 0.5;
  * *
  * *        if(temp.rgba == temp2.rgba && findDistance(temp, temp2)<50){
  * *           ctx.strokeStyle = temp.rgba;
  * *           ctx.beginPath();
  * *           ctx.moveTo(temp.x, temp.y);
  * *           ctx.lineTo(temp2.x, temp2.y);
  * *           ctx.stroke();
  * *           factor++;
  * *        }
  * *     }
  * *
  * *
  * *     ctx.fillStyle = temp.rgba;
  * *     ctx.strokeStyle = temp.rgba;
  * *
  * *     ctx.beginPath();
  * *     ctx.arc(temp.x, temp.y, temp.rad*factor, 0, Math.PI*2, true);
  * *     ctx.fill();
  * *     ctx.closePath();
  * *
  * *     ctx.beginPath();
  * *     ctx.arc(temp.x, temp.y, (temp.rad+5)*factor, 0, Math.PI*2, true);
  * *     ctx.stroke();
  * *     ctx.closePath();
  * *
  * *
  * *     temp.x += temp.vx;
  * *     temp.y += temp.vy;
  * *
  * *     if(temp.x > w)temp.x = 0;
  * *     if(temp.x < 0)temp.x = w;
  * *     if(temp.y > h)temp.y = 0;
  * *     if(temp.y < 0)temp.y = h;
  * *   }
  * * }
  * *
  * * function findDistance(p1,p2){
  * *   return Math.sqrt( Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2) );
  * * }
  * *
  * *  })(); */
</script>
